// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Guild {
  id                      String                   @unique
  createdAt               DateTime                 @default(now())
  updatedAt               DateTime                 @updatedAt
  GuildMember             GuildMember[]
  GuildSettings           GuildSettings?
  GuildEmbedSettings      GuildEmbedSettings?
  GuildCreditsSettings    GuildCreditsSettings?
  GuildPointsSettings     GuildPointsSettings?
  GuildReputationSettings GuildReputationSettings?
  GuildCountersSettings   GuildCountersSettings?
  GuildAuditsSettings     GuildAuditsSettings?
  GuildShopSettings       GuildShopSettings?
  GuildWelcomeSettings    GuildWelcomeSettings?
  ApiCredentials          ApiCredentials[]
}

model User {
  id             String           @unique
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  GuildMember    GuildMember[]
  ApiCredentials ApiCredentials[]
}

model GuildMember {
  guildId               String
  userId                String
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @default(now())
  Guild                 Guild                  @relation(fields: [guildId], references: [id])
  User                  User                   @relation(fields: [userId], references: [id])
  GuildMemberCredit     GuildMemberCredit?
  GuildMemberReputation GuildMemberReputation?
  ApiCredentials        ApiCredentials[]

  @@unique([guildId, userId])
}

model GuildMemberCredit {
  guildId   String
  userId    String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  GuildMember GuildMember @relation(fields: [guildId, userId], references: [guildId, userId])
  balance     Int         @default(0)

  @@unique([guildId, userId])
}

model GuildMemberReputation {
  guildId   String
  userId    String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  guildMember GuildMember @relation(fields: [guildId, userId], references: [guildId, userId])

  negative Int @default(0)
  positive Int @default(0)

  @@unique([guildId, userId])
}

model GuildSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  embedSettings             GuildEmbedSettings?      @relation(fields: [guildEmbedSettingsId], references: [id])
  creditsSettings           GuildCreditsSettings?    @relation(fields: [guildCreditsSettingsId], references: [id])
  pointsSettings            GuildPointsSettings?     @relation(fields: [guildPointsSettingsId], references: [id])
  reputationSettings        GuildReputationSettings? @relation(fields: [guildReputationSettingsId], references: [id])
  countersSettings          GuildCountersSettings?   @relation(fields: [guildCountersSettingsId], references: [id])
  auditsSettings            GuildAuditsSettings?     @relation(fields: [guildAuditsSettingsId], references: [id])
  shopSettings              GuildShopSettings?       @relation(fields: [guildShopSettingsId], references: [id])
  welcomeSettings           GuildWelcomeSettings?    @relation(fields: [guildWelcomeSettingsId], references: [id])
  guildEmbedSettingsId      String?
  guildCreditsSettingsId    String?
  guildPointsSettingsId     String?
  guildReputationSettingsId String?
  guildCountersSettingsId   String?
  guildAuditsSettingsId     String?
  guildShopSettingsId       String?
  guildWelcomeSettingsId    String?
}

model GuildEmbedSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  successColor  String?         @default("#22bb33")
  waitColor     String?         @default("#f0ad4e")
  errorColor    String?         @default("#bb2124")
  footerText    String?         @default("https://github.com/ZynerOrg/xyter")
  footerIcon    String?         @default("https://github.com/ZynerOrg.png")
  GuildSettings GuildSettings[]
}

model GuildCreditsSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  workBonusChance   Int             @default(30)
  workPenaltyChance Int             @default(10)
  status            Boolean         @default(false)
  rate              Int             @default(1)
  timeout           Int             @default(5)
  workRate          Int             @default(25)
  workTimeout       Int             @default(86400)
  minimumLength     Int             @default(5)
  GuildSettings     GuildSettings[]
}

model GuildPointsSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  status        Boolean         @default(false)
  rate          Int             @default(1)
  timeout       Int             @default(5)
  minimumLength Int             @default(5)
  GuildSettings GuildSettings[]
}

model GuildReputationSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  status        Boolean         @default(false)
  GuildSettings GuildSettings[]
}

model GuildCountersSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  status        Boolean         @default(false)
  GuildSettings GuildSettings[]
}

model GuildAuditsSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  status        Boolean         @default(false)
  channelId     String?
  GuildSettings GuildSettings[]
}

model GuildShopSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  status        Boolean         @default(false)
  GuildSettings GuildSettings[]
}

model GuildWelcomeSettings {
  id        String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild Guild @relation(fields: [id], references: [id])

  status              Boolean         @default(false)
  joinChannelId       String?
  joinChannelMessage  String?
  leaveChannelId      String?
  leaveChannelMessage String?
  GuildSettings       GuildSettings[]
}

model ApiCredentials {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  guild   Guild?  @relation(fields: [guildId], references: [id])
  guildId String?

  user   User?   @relation(fields: [userId], references: [id])
  userId String?

  guildMember GuildMember? @relation(fields: [guildId, userId], references: [guildId, userId])

  apiName     String
  credentials Json

  @@unique([guildId, apiName])
  @@unique([userId, apiName])
}

// model GuildConfigEmbeds {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   successColor String @default("#22bb33")
//   waitColor    String @default("#f0ad4e")
//   errorColor   String @default("#bb2124")
//   footerText   String @default("https://github.com/ZynerOrg/xyter")
//   footerIcon   String @default("https://github.com/ZynerOrg.png")
// }

// model GuildConfigCredits {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   status        Boolean @default(false)
//   rate          Int     @default(1)
//   timeout       Int     @default(5)
//   workRate      Int     @default(25)
//   workTimeout   Int     @default(86400)
//   minimumLength Int     @default(5)
// }

// model GuildConfigPoints {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   status        Boolean @default(false)
//   rate          Int     @default(1)
//   timeout       Int     @default(5)
//   minimumLength Int     @default(5)
// }

// model GuildConfigReputation {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   status Boolean @default(false)
// }

// model GuildConfigCounters {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   status Boolean @default(false)
// }

// model GuildConfigApisCpgg {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   urlIv        String?
//   urlContent   String?
//   tokenIv      String?
//   tokenContent String?
// }

// model GuildConfigAudits {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   status    Boolean @default(false)
//   channelId String
// }

// model GuildConfigShop {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   status Boolean @default(false)
// }

// model GuildConfigWelcome {
//   id        String   @unique
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [id], references: [id])

//   status              Boolean @default(false)
//   joinChannelId       String?
//   joinChannelMessage  String?
//   leaveChannelId      String?
//   leaveChannelMessage String?
// }

// model GuildCounters {
//   guildId   String
//   channelId String
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [guildId], references: [id])

//   triggerWord String
//   count       Int    @default(0)

//   @@unique([guildId, channelId])
// }

// model GuildMemberCredit {
//   userId  String
//   guildId String

//   guildMember GuildMember @relation(fields: [userId, guildId], references: [userId, guildId])

//   balance Int @default(0)

//   @@unique([userId, guildId])
// }

// model Cooldown {
//   guildId   String
//   userId    String
//   timeoutId String
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   guild Guild @relation(fields: [guildId], references: [id])
//   user  User  @relation(fields: [userId], references: [id])

//   cooldown Int

//   @@unique([guildId, userId, timeoutId])
// }
